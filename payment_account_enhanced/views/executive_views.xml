<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ========================================== -->
    <!-- EXECUTIVE SEARCH VIEWS WITH FILTERS -->
    <!-- ========================================== -->

    <!-- Enhanced Payment Search View with Executive Filters -->
    <record id="view_account_payment_search_executive" model="ir.ui.view">
        <field name="name">account.payment.search.executive</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="account.view_account_payment_search"/>
        <field name="priority" eval="90"/>
        <field name="arch" type="xml">
            
            <!-- Add executive-focused filters -->
            <xpath expr="//search" position="inside">
                
                <!-- Executive Quick Filters -->
                <separator/>
                <filter string="Large Payments (&gt;$10K)" name="large_payments" domain="[('amount', '&gt;=', 10000)]"/>
                <filter string="Very Large Payments (&gt;$50K)" name="very_large_payments" domain="[('amount', '&gt;=', 50000)]"/>
                <filter string="Critical Payments (&gt;$100K)" name="critical_payments" domain="[('amount', '&gt;=', 100000)]"/>
                
                <separator/>
                <filter string="Pending My Attention" name="pending_attention" 
                        domain="['|', '|', 
                                ('approval_state', '=', 'under_review'), 
                                ('approval_state', '=', 'for_approval'),
                                ('approval_state', '=', 'for_authorization')]"/>
                <filter string="Needs Executive Authorization" name="needs_authorization" domain="[('approval_state', '=', 'for_authorization')]"/>
                <filter string="Recently Approved" name="recently_approved" domain="[('approval_state', '=', 'approved')]"/>
                
                <!-- Time-based executive filters (simplified to avoid XML parsing issues) -->
                <separator/>
                <filter string="This Week" name="this_week" domain="[]"/>
                <filter string="This Month" name="this_month" domain="[]"/>
                <filter string="This Quarter" name="this_quarter" domain="[]"/>
                <filter string="This Year" name="this_year" domain="[]"/>
                
                <!-- Exception filters -->
                <separator/>
                <filter string="Overdue Approvals" name="overdue_approvals" 
                        domain="[('approval_state', 'in', ['under_review', 'for_approval', 'for_authorization'])]"/>
                <filter string="Rejected Payments" name="rejected_payments" domain="[('approval_state', '=', 'cancelled')]"/>
                
                <!-- Executive Group By options -->
                <group expand="0" string="Executive Analysis">
                    <filter string="Approval State" name="group_by_approval_state" context="{'group_by': 'approval_state'}"/>
                    <filter string="Amount Range" name="group_by_amount_range" context="{'group_by': 'amount'}"/>
                    <filter string="Payment Type" name="group_by_payment_type" context="{'group_by': 'payment_type'}"/>
                    <filter string="Partner" name="group_by_partner" context="{'group_by': 'partner_id'}"/>
                    <filter string="Month" name="group_by_month" context="{'group_by': 'date:month'}"/>
                    <filter string="Week" name="group_by_week" context="{'group_by': 'date:week'}"/>
                    <filter string="Approver" name="group_by_approver" context="{'group_by': 'approver_id'}"/>
                    <filter string="Authorizer" name="group_by_authorizer" context="{'group_by': 'authorizer_id'}"/>
                </group>
                
            </xpath>
        </field>
    </record>

    <!-- ========================================== -->
    <!-- EXECUTIVE TREE VIEW WITH KPI STYLING -->
    <!-- ========================================== -->

    <!-- Executive Payment Tree View with Enhanced Styling -->
    <record id="view_account_payment_tree_executive" model="ir.ui.view">
        <field name="name">account.payment.tree.executive</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="payment_account_enhanced.view_account_payment_tree_enhanced"/>
        <field name="priority" eval="95"/>
        <field name="arch" type="xml">
            
            <!-- Add executive-focused decorations to the tree -->
            <xpath expr="//tree" position="attributes">
                <attribute name="decoration-danger">amount &gt;= 100000 and approval_state in ['under_review', 'for_approval', 'for_authorization']</attribute>
                <attribute name="decoration-warning">amount &gt;= 50000 and approval_state in ['under_review', 'for_approval']</attribute>
                <attribute name="decoration-info">amount &gt;= 10000 and approval_state == 'approved'</attribute>
                <attribute name="decoration-success">approval_state == 'posted'</attribute>
                <attribute name="decoration-muted">approval_state == 'cancelled'</attribute>
            </xpath>

            <!-- Add approval timing fields for executive oversight -->
            <xpath expr="//field[@name='approval_state']" position="after">
                <field name="reviewer_date" optional="hide" string="Review Date"/>
                <field name="approver_date" optional="hide" string="Approval Date"/>
                <field name="authorizer_date" optional="show" string="Authorization Date"/>
                <field name="reviewer_id" optional="hide" string="Reviewer"/>
                <field name="approver_id" optional="hide" string="Approver"/>
                <field name="authorizer_id" optional="show" string="Authorizer"/>
            </xpath>

        </field>
    </record>

    <!-- ========================================== -->
    <!-- EXECUTIVE ACTIONS WITH ENHANCED CONTEXT -->
    <!-- ========================================== -->

    <!-- Executive Payment Summary Action - Enhanced -->
    <record id="action_account_payment_executive_enhanced" model="ir.actions.act_window">
        <field name="name">Executive Payment Center</field>
        <field name="res_model">account.payment</field>
        <field name="view_mode">tree,form,pivot,graph</field>
        <field name="view_id" ref="view_account_payment_tree_executive"/>
        <field name="search_view_id" ref="view_account_payment_search_executive"/>
        <field name="context">{
            'create': False,
            'search_default_this_month': 1,
            'search_default_large_payments': 1,
            'search_default_group_by_approval_state': 1
        }</field>
        <field name="domain">[('amount', '>', 0)]</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Executive Payment Command Center
            </p>
            <p>
                <strong>Welcome to your executive payment overview.</strong><br/>
                This dashboard provides high-level insights into payment activities, approval workflows, and financial oversight.
            </p>
            <ul>
                <li><strong>Large Payments:</strong> Focus on significant financial transactions</li>
                <li><strong>Approval Status:</strong> Monitor workflow bottlenecks</li>
                <li><strong>Authorization Queue:</strong> Payments requiring executive approval</li>
                <li><strong>Risk Management:</strong> Overdue approvals and exceptions</li>
            </ul>
            <p>Use the filters above to drill down into specific areas of concern or interest.</p>
        </field>
    </record>

    <!-- Quick Executive Dashboard Action -->
    <record id="action_payment_executive_quick_dashboard" model="ir.actions.act_window">
        <field name="name">Executive Dashboard - Quick View</field>
        <field name="res_model">account.payment</field>
        <field name="view_mode">pivot,graph</field>
        <field name="search_view_id" ref="view_account_payment_search_executive"/>
        <field name="context">{
            'search_default_this_quarter': 1,
            'search_default_large_payments': 1,
            'group_by': ['approval_state', 'payment_type', 'date:month'],
            'pivot_measures': ['amount'],
            'pivot_column_groupby': ['approval_state'],
            'pivot_row_groupby': ['date:month', 'payment_type']
        }</field>
        <field name="domain">[('amount', '&gt;=', 5000)]</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Executive Quick Dashboard
            </p>
            <p>
                Rapid insights for executive decision-making focused on significant payments and approval trends.
            </p>
        </field>
    </record>

</odoo>
