<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Enhanced Sales Offer Report - Optimized Layout -->
    <template id="property_brochure_enhanced_template">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="web.external_layout">
                    <!-- PAGE 1: Property Overview -->
                    <div class="page" style="font-family: 'Helvetica', 'Arial', sans-serif; font-size: 10.5pt; page-break-after: always;">

                        <!-- Header with Validity Banner -->
                        <div style="background: linear-gradient(135deg, #C5A572 0%, #8B7355 100%); color: white; padding: 12px 20px; text-align: center; border-radius: 6px; margin-bottom: 15px;">
                            <h1 style="margin: 0 0 6px 0; font-size: 26pt; font-weight: bold;">
                                <span t-field="doc.name"/>
                            </h1>
                            <p style="margin: 0 0 8px 0; font-size: 11pt; opacity: 0.95;">
                                <span t-field="doc.property_seq"/> | <span t-field="doc.type"/>
                                <t t-if="doc.property_subtype_id"> - <span t-field="doc.property_subtype_id"/></t>
                            </p>
                            <div style="background: rgba(255,255,255,0.2); padding: 6px 15px; border-radius: 4px; font-size: 9pt; font-weight: bold; display: inline-block;">
                                ⏰ This offer is valid for 1 day, subject to availability
                            </div>
                        </div>

                        <!-- Gallery Row - 4 Images -->
                        <t t-if="doc.is_images and doc.property_images_ids">
                            <div style="display: table; width: 100%; margin-bottom: 15px;">
                                <t t-foreach="doc.property_images_ids[:4]" t-as="img">
                                    <div style="display: table-cell; width: 25%; padding: 0 3px;" t-if="img.image">
                                        <img t-att-src="image_data_uri(img.image)" style="width: 100%; height: 140px; object-fit: cover; border-radius: 5px; border: 2px solid #C5A572;"/>
                                        <p style="margin: 3px 0 0 0; font-size: 7pt; color: #666; text-align: center;" t-if="img.title">
                                            <span t-field="img.title"/>
                                        </p>
                                    </div>
                                </t>
                            </div>
                        </t>

                        <!-- Two Column Information Layout -->
                        <div style="display: table; width: 100%;">
                            
                            <!-- LEFT COLUMN - 48% -->
                            <div style="display: table-cell; width: 48%; vertical-align: top; padding-right: 2%;">
                                
                                <!-- Property Details -->
                                <div style="background: linear-gradient(135deg, #8B7355 0%, #C5A572 100%); color: white; padding: 8px 15px; border-radius: 5px; margin-bottom: 12px;">
                                    <h2 style="margin: 0; font-size: 13pt; font-weight: bold;">Property Details</h2>
                                </div>
                                <div style="background: #f9f9f9; padding: 12px 15px; border-radius: 5px; border-left: 4px solid #C5A572; margin-bottom: 15px; font-size: 10pt; line-height: 1.8;">
                                    <p style="margin: 0 0 6px 0;" t-if="doc.sale_lease"><strong style="color: #8B7355;">Type:</strong> <span t-field="doc.sale_lease" style="font-size: 11pt;"/></p>
                                    <p style="margin: 0 0 6px 0;" t-if="doc.price"><strong style="color: #8B7355;">Price:</strong> <span style="font-size: 12pt; font-weight: bold; color: #C5A572;"><t t-esc="'{:,.2f}'.format(doc.price)"/> AED</span></p>
                                    <t t-if="doc.type == 'residential'">
                                        <p style="margin: 0 0 6px 0;" t-if="doc.bed"><strong style="color: #8B7355;">Bedrooms:</strong> <span t-field="doc.bed" style="font-size: 11pt;"/></p>
                                        <p style="margin: 0 0 6px 0;" t-if="doc.bathroom"><strong style="color: #8B7355;">Bathrooms:</strong> <span t-field="doc.bathroom" style="font-size: 11pt;"/></p>
                                        <p style="margin: 0 0 6px 0;" t-if="doc.unit_type"><strong style="color: #8B7355;">Unit Type:</strong> <span t-field="doc.unit_type" style="font-size: 11pt;"/></p>
                                    </t>
                                    <p style="margin: 0 0 6px 0;" t-if="doc.total_floor"><strong style="color: #8B7355;">Floor:</strong> <span t-field="doc.total_floor" style="font-size: 11pt;"/></p>
                                    <p style="margin: 0 0 6px 0;" t-if="doc.total_area"><strong style="color: #8B7355;">Size:</strong> <span style="font-size: 11pt;"><t t-esc="'{:,.2f}'.format(doc.total_area)"/> <t t-if="doc.measure_unit"><span t-field="doc.measure_unit"/></t></span></p>
                                    <p style="margin: 0 0 6px 0;" t-if="doc.facing"><strong style="color: #8B7355;">View:</strong> <span t-field="doc.facing" style="font-size: 11pt;"/></p>
                                    <p style="margin: 0;" t-if="doc.dld_fee_amount"><strong style="color: #8B7355;">Reg. Fees:</strong> <span style="font-size: 11pt;"><t t-esc="'{:,.2f}'.format(doc.dld_fee_amount)"/> AED</span></p>
                                </div>

                                <!-- Location & Contact Combined -->
                                <div style="background: linear-gradient(135deg, #8B7355 0%, #C5A572 100%); color: white; padding: 8px 15px; border-radius: 5px; margin-bottom: 12px;">
                                    <h3 style="margin: 0; font-size: 13pt; font-weight: bold;">Location &amp; Contact</h3>
                                </div>
                                <div style="background: #f9f9f9; padding: 12px 15px; border-radius: 5px; margin-bottom: 15px; font-size: 10pt; line-height: 1.8;">
                                    <t t-if="doc.street or doc.city_id">
                                        <p style="margin: 0 0 10px 0; padding-bottom: 10px; border-bottom: 1px dashed #ddd;">
                                            <strong style="color: #8B7355; font-size: 11pt;">Address:</strong><br/>
                                            <span style="font-size: 10pt;">
                                                <t t-if="doc.street"><span t-field="doc.street"/><br/></t>
                                                <t t-if="doc.city_id"><span t-field="doc.city_id"/></t>
                                                <t t-if="doc.state_id">, <span t-field="doc.state_id"/></t>
                                                <t t-if="doc.region_id"><br/><span t-field="doc.region_id"/></t>
                                            </span>
                                        </p>
                                    </t>
                                    <t t-if="doc.landlord_id or doc.landlord_phone">
                                        <p style="margin: 0 0 6px 0;" t-if="doc.landlord_id"><strong style="color: #8B7355;">Developer:</strong> <span t-field="doc.landlord_id" style="font-size: 11pt;"/></p>
                                        <p style="margin: 0 0 6px 0;" t-if="doc.landlord_phone"><strong style="color: #8B7355;">Phone:</strong> <span t-field="doc.landlord_phone" style="font-size: 11pt;"/></p>
                                        <p style="margin: 0;" t-if="doc.landlord_email"><strong style="color: #8B7355;">Email:</strong> <span t-field="doc.landlord_email" style="font-size: 10pt;"/></p>
                                    </t>
                                </div>

                                <!-- Bank Details -->
                                <div style="background: linear-gradient(135deg, #8B7355 0%, #C5A572 100%); color: white; padding: 8px 15px; border-radius: 5px; margin-bottom: 12px;">
                                    <h3 style="margin: 0; font-size: 13pt; font-weight: bold;">Bank Details</h3>
                                </div>
                                <div style="background: #f9f9f9; padding: 12px 15px; border-radius: 5px; font-size: 9pt; line-height: 1.8;">
                                    <p style="margin: 0 0 6px 0;"><strong style="color: #8B7355;">Beneficiary:</strong> G J R E Real Estate LLC</p>
                                    <p style="margin: 0 0 6px 0;"><strong style="color: #8B7355;">Bank:</strong> ABU DHABI COMMERCIAL BANK</p>
                                    <p style="margin: 0 0 6px 0;"><strong style="color: #8B7355;">Account:</strong> 12830238920001</p>
                                    <p style="margin: 0 0 6px 0;"><strong style="color: #8B7355;">IBAN:</strong> AE370030012830238920001</p>
                                    <p style="margin: 0 0 6px 0;"><strong style="color: #8B7355;">Swift:</strong> ADCBAEAA</p>
                                    <p style="margin: 0;"><strong style="color: #8B7355;">Currency:</strong> AED</p>
                                </div>
                            </div>

                            <!-- RIGHT COLUMN - 48% -->
                            <div style="display: table-cell; width: 48%; vertical-align: top; padding-left: 2%;">
                                
                                <!-- Amenities & Specifications Combined -->
                                <t t-if="doc.amenities and doc.amenities_ids">
                                    <div style="background: linear-gradient(135deg, #8B7355 0%, #C5A572 100%); color: white; padding: 8px 15px; border-radius: 5px; margin-bottom: 12px;">
                                        <h3 style="margin: 0; font-size: 13pt; font-weight: bold;">Amenities</h3>
                                    </div>
                                    <div style="display: table; width: 100%; margin-bottom: 15px;">
                                        <t t-foreach="doc.amenities_ids[:8]" t-as="amenity">
                                            <div style="display: table-cell; width: 25%; text-align: center; padding: 8px;">
                                                <t t-if="amenity.image">
                                                    <img t-att-src="image_data_uri(amenity.image)" style="width: 40px; height: 40px; border-radius: 50%; border: 3px solid #C5A572; margin-bottom: 5px;"/>
                                                </t>
                                                <p style="margin: 0; font-size: 8.5pt; color: #333; font-weight: 500;">
                                                    <span t-field="amenity.title"/>
                                                </p>
                                            </div>
                                        </t>
                                    </div>
                                </t>

                                <!-- Specifications -->
                                <t t-if="doc.is_facilities and doc.property_specification_ids">
                                    <div style="background: linear-gradient(135deg, #8B7355 0%, #C5A572 100%); color: white; padding: 8px 15px; border-radius: 5px; margin-bottom: 12px;">
                                        <h3 style="margin: 0; font-size: 13pt; font-weight: bold;">Specifications</h3>
                                    </div>
                                    <div style="background: #f9f9f9; padding: 12px 15px; border-radius: 5px; margin-bottom: 15px; font-size: 10pt;">
                                        <t t-foreach="doc.property_specification_ids[:6]" t-as="spec">
                                            <p style="margin: 0 0 8px 0; padding-bottom: 8px; border-bottom: 1px dashed #ddd; line-height: 1.6;">
                                                <strong style="color: #8B7355; font-size: 10.5pt;"><span t-field="spec.title"/>:</strong><br/>
                                                <span t-field="spec.description" style="color: #555; font-size: 10pt;" t-if="spec.description"/>
                                            </p>
                                        </t>
                                    </div>
                                </t>

                                <!-- Nearby Landmarks -->
                                <t t-if="doc.nearby_connectivity and doc.connectivity_ids">
                                    <div style="background: linear-gradient(135deg, #8B7355 0%, #C5A572 100%); color: white; padding: 8px 15px; border-radius: 5px; margin-bottom: 12px;">
                                        <h3 style="margin: 0; font-size: 13pt; font-weight: bold;">Nearby Locations</h3>
                                    </div>
                                    <div style="background: #f9f9f9; padding: 12px 15px; border-radius: 5px; font-size: 10pt; line-height: 1.8;">
                                        <t t-foreach="doc.connectivity_ids[:8]" t-as="conn">
                                            <p style="margin: 0 0 6px 0;">
                                                <strong style="color: #8B7355;"><span t-field="conn.connectivity_id"/>:</strong>
                                                <span t-field="conn.name"/>
                                                <t t-if="conn.distance"> (<span t-field="conn.distance" style="color: #C5A572; font-weight: bold;"/>)</t>
                                            </p>
                                        </t>
                                    </div>
                                </t>
                            </div>
                        </div>
                    </div>

                    <!-- PAGE 2: Floor Plans and Payment -->
                    <t t-if="(doc.is_floor_plan and doc.floreplan_ids) or (doc.sale_lease == 'for_sale' and doc.is_payment_plan and doc.custom_payment_plan_line_ids)">
                        <div class="page" style="font-family: 'Helvetica', 'Arial', sans-serif; font-size: 10.5pt;">

                            <!-- Header -->
                            <div style="background: linear-gradient(135deg, #C5A572 0%, #8B7355 100%); color: white; padding: 12px 20px; text-align: center; border-radius: 6px; margin-bottom: 15px;">
                                <h1 style="margin: 0 0 6px 0; font-size: 24pt; font-weight: bold;">
                                    <span t-field="doc.name"/>
                                </h1>
                                <p style="margin: 0 0 8px 0; font-size: 11pt; opacity: 0.95;">
                                    <t t-if="doc.is_floor_plan and doc.floreplan_ids">Floor Plans</t>
                                    <t t-if="(doc.is_floor_plan and doc.floreplan_ids) and (doc.sale_lease == 'for_sale' and doc.is_payment_plan and doc.custom_payment_plan_line_ids)"> | </t>
                                    <t t-if="doc.sale_lease == 'for_sale' and doc.is_payment_plan and doc.custom_payment_plan_line_ids">Payment Plan Details</t>
                                </p>
                                <div style="background: rgba(255,255,255,0.2); padding: 6px 15px; border-radius: 4px; font-size: 9pt; font-weight: bold; display: inline-block;">
                                    ⏰ This offer is valid for 1 day, subject to availability
                                </div>
                            </div>

                            <!-- Important Notes Banner -->
                            <div style="background: #fff8f0; border-left: 4px solid #C5A572; padding: 10px 15px; margin-bottom: 15px; font-size: 9pt; color: #666; font-style: italic; line-height: 1.6;">
                                <strong style="color: #8B7355;">Important Note:</strong> All drawings and sizes are approximate. Drawings are not to scale and can be changed without notice. The developer reserves the right to make changes. All payments are subject to the terms and conditions outlined in the Sales Purchase Agreement (SPA).
                            </div>

                            <!-- Floor Plans Section (Full Width) -->
                            <t t-if="doc.is_floor_plan and doc.floreplan_ids">
                                <div style="background: linear-gradient(135deg, #8B7355 0%, #C5A572 100%); color: white; padding: 8px 15px; border-radius: 5px; margin-bottom: 12px;">
                                    <h2 style="margin: 0; font-size: 14pt; font-weight: bold;">Floor Plans</h2>
                                </div>
                                <t t-foreach="doc.floreplan_ids[:2]" t-as="plan">
                                    <div style="margin-bottom: 15px; text-align: center;">
                                        <h3 style="color: #8B7355; font-size: 11pt; margin: 0 0 8px 0; font-weight: bold;" t-if="plan.title">
                                            <span t-field="plan.title"/>
                                        </h3>
                                        <t t-if="plan.image">
                                            <img t-att-src="image_data_uri(plan.image)" style="width: 100%; max-height: 380px; object-fit: contain; border: 3px solid #C5A572; border-radius: 6px; padding: 10px; background: #f9f9f9; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"/>
                                        </t>
                                    </div>
                                </t>
                            </t>

                            <!-- Payment Plan Section -->
                            <t t-if="doc.sale_lease == 'for_sale' and doc.is_payment_plan and doc.custom_payment_plan_line_ids">
                                
                                <!-- Payment Plan Header -->
                                <div style="background: linear-gradient(135deg, #8B7355 0%, #C5A572 100%); color: white; padding: 8px 15px; border-radius: 5px; margin-bottom: 12px; margin-top: 20px;">
                                    <h2 style="margin: 0; font-size: 14pt; font-weight: bold;">Plan of Installments</h2>
                                </div>
                                
                                <!-- Payment Table with 4 Columns -->
                                <table style="width: 100%; border-collapse: collapse; font-size: 9.5pt; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                                    <thead>
                                        <tr style="background: linear-gradient(135deg, #8B7355 0%, #C5A572 100%); color: white;">
                                            <th style="padding: 8px 10px; text-align: left; border: 1px solid white; font-size: 10pt; width: 8%;">#</th>
                                            <th style="padding: 8px 10px; text-align: left; border: 1px solid white; font-size: 10pt; width: 47%;">Installment</th>
                                            <th style="padding: 8px 10px; text-align: center; border: 1px solid white; font-size: 10pt; width: 15%;">% of Price</th>
                                            <th style="padding: 8px 10px; text-align: right; border: 1px solid white; font-size: 10pt; width: 30%;">Amount AED</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-foreach="doc.custom_payment_plan_line_ids" t-as="line">
                                            <tr style="background: #f9f9f9; border-bottom: 1px solid #ddd;">
                                                <td style="padding: 6px 10px; border: 1px solid #ddd; font-size: 9pt; font-weight: bold; color: #8B7355; text-align: center;">
                                                    <t t-esc="line_index + 1"/>
                                                </td>
                                                <td style="padding: 6px 10px; border: 1px solid #ddd; font-size: 9pt;">
                                                    <span t-field="line.name"/>
                                                </td>
                                                <td style="padding: 6px 10px; text-align: center; border: 1px solid #ddd; font-size: 9.5pt;">
                                                    <strong style="color: #C5A572;"><t t-esc="'{:.1f}'.format(line.percentage)"/> %</strong>
                                                </td>
                                                <td style="padding: 6px 10px; text-align: right; border: 1px solid #ddd; font-size: 9.5pt;">
                                                    <strong style="color: #8B7355;"><t t-esc="'{:,.2f}'.format(line.amount)"/></strong>
                                                </td>
                                            </tr>
                                        </t>
                                        <!-- Total Row -->
                                        <tr style="background: linear-gradient(135deg, #fff8f0 0%, #fef5ea 100%); font-weight: bold;">
                                            <td colspan="2" style="padding: 8px 10px; border: 2px solid #C5A572; font-size: 10pt; text-align: right;">
                                                <strong style="color: #8B7355;">TOTAL:</strong>
                                            </td>
                                            <td style="padding: 8px 10px; text-align: center; border: 2px solid #C5A572; font-size: 10.5pt; color: #C5A572;">
                                                100.0 %
                                            </td>
                                            <td style="padding: 8px 10px; text-align: right; border: 2px solid #C5A572; font-size: 11pt; color: #8B7355;">
                                                <t t-esc="'{:,.2f}'.format(doc.price)"/>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <!-- Registration Fees, Booking Amount - 3 Column Layout -->
                                <div style="display: table; width: 100%; margin-top: 15px;">
                                    
                                    <!-- Registration Fees -->
                                    <div style="display: table-cell; width: 32%; padding-right: 2%; vertical-align: top;">
                                        <div style="background: linear-gradient(135deg, #8B7355 0%, #C5A572 100%); color: white; padding: 6px 12px; border-radius: 5px; margin-bottom: 10px;">
                                            <h3 style="margin: 0; font-size: 11pt; font-weight: bold;">Registration Fees*</h3>
                                        </div>
                                        <table style="width: 100%; border-collapse: collapse; font-size: 9pt;">
                                            <tbody>
                                                <tr style="background: #f9f9f9;" t-if="doc.dld_fee_amount">
                                                    <td style="padding: 6px 8px; border: 1px solid #ddd; font-size: 8.5pt;">4% DLD + AED 40</td>
                                                    <td style="padding: 6px 8px; text-align: right; border: 1px solid #ddd; font-weight: bold;">
                                                        <t t-esc="'{:,.2f}'.format(doc.dld_fee_amount)"/>
                                                    </td>
                                                </tr>
                                                <tr style="background: #f9f9f9;">
                                                    <td style="padding: 6px 8px; border: 1px solid #ddd; font-size: 8.5pt;">Oqood Fee (VAT)</td>
                                                    <td style="padding: 6px 8px; text-align: right; border: 1px solid #ddd; font-weight: bold;">
                                                        2,100.00
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                    <!-- Booking Amount -->
                                    <div style="display: table-cell; width: 32%; padding: 0 1%; vertical-align: top;">
                                        <div style="background: linear-gradient(135deg, #8B7355 0%, #C5A572 100%); color: white; padding: 6px 12px; border-radius: 5px; margin-bottom: 10px;">
                                            <h3 style="margin: 0; font-size: 11pt; font-weight: bold;">Booking Amount</h3>
                                        </div>
                                        <table style="width: 100%; border-collapse: collapse; font-size: 9pt;">
                                            <tbody>
                                                <tr style="background: #f9f9f9;">
                                                    <td style="padding: 6px 8px; border: 1px solid #ddd; font-weight: bold; font-size: 8.5pt;">Sales Price</td>
                                                    <td style="padding: 6px 8px; text-align: right; border: 1px solid #ddd; font-weight: bold; color: #8B7355;">
                                                        <t t-esc="'{:,.2f}'.format(doc.price)"/>
                                                    </td>
                                                </tr>
                                                <t t-if="doc.custom_payment_plan_line_ids and doc.custom_payment_plan_line_ids[0]">
                                                    <tr style="background: #fff8f0;">
                                                        <td style="padding: 6px 8px; border: 1px solid #ddd; font-weight: bold; font-size: 8.5pt;">To Book</td>
                                                        <td style="padding: 6px 8px; text-align: right; border: 1px solid #ddd; font-weight: bold; color: #C5A572;">
                                                            <t t-esc="'{:,.2f}'.format(doc.custom_payment_plan_line_ids[0].amount)"/>
                                                        </td>
                                                    </tr>
                                                </t>
                                            </tbody>
                                        </table>
                                    </div>

                                    <!-- Summary Box -->
                                    <div style="display: table-cell; width: 32%; padding-left: 2%; vertical-align: top;">
                                        <div style="background: linear-gradient(135deg, #8B7355 0%, #C5A572 100%); color: white; padding: 6px 12px; border-radius: 5px; margin-bottom: 10px;">
                                            <h3 style="margin: 0; font-size: 11pt; font-weight: bold;">Payment Summary</h3>
                                        </div>
                                        <div style="background: #fff8f0; padding: 10px 12px; border: 2px solid #C5A572; border-radius: 5px; font-size: 9pt; line-height: 1.8;">
                                            <p style="margin: 0 0 6px 0;"><strong style="color: #8B7355;">Total Installments:</strong> <t t-esc="len(doc.custom_payment_plan_line_ids)"/></p>
                                            <p style="margin: 0 0 6px 0;"><strong style="color: #8B7355;">Payment Tenure:</strong> ~4 Years</p>
                                            <p style="margin: 0;"><strong style="color: #8B7355;">Frequency:</strong> Half-Yearly</p>
                                        </div>
                                    </div>
                                </div>
                            </t>

                            <!-- Footer -->
                            <div style="margin-top: 15px; padding-top: 10px; border-top: 2px solid #C5A572;">
                                <t t-if="doc.landlord_phone or doc.landlord_email">
                                    <div style="text-align: center; font-size: 8pt; margin-bottom: 8px;">
                                        <p style="margin: 0 0 3px 0; color: #8B7355; font-weight: bold;">
                                            For inquiries, please contact:
                                            <t t-if="doc.landlord_phone"><span t-field="doc.landlord_phone"/></t>
                                            <t t-if="doc.landlord_email and doc.landlord_phone"> | </t>
                                            <t t-if="doc.landlord_email"><span t-field="doc.landlord_email"/></t>
                                        </p>
                                    </div>
                                </t>
                                <div style="background: #fff8f0; border: 1px solid #C5A572; padding: 6px; border-radius: 4px; font-size: 6.5pt; color: #666; text-align: center; font-style: italic;">
                                    This Sales Offer Is System Generated by G J Properties on <span t-esc="datetime.datetime.now().strftime('%A, %d. %B %Y')"/>
                                    <br/>© <span t-esc="datetime.datetime.now().year"/> - All Rights Reserved
                                </div>
                            </div>
                        </div>
                    </t>
                </t>
            </t>
        </t>
    </template>

    <!-- Report Action -->
    <record id="property_brochure_enhanced_report_action" model="ir.actions.report">
        <field name="name">Sales Offer</field>
        <field name="model">property.details</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">rental_management.property_brochure_enhanced_template</field>
        <field name="report_file">rental_management.property_brochure_enhanced_template</field>
        <field name="binding_model_id" ref="model_property_details"/>
        <field name="binding_type">report</field>
        <field name="print_report_name">'Sales Offer - %s' % (object.name)</field>
        <field name="paperformat_id" ref="base.paperformat_us"/>
    </record>
</odoo>
