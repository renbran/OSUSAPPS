<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Model Access Records -->
        <record id="model_order_status" model="ir.model">
            <field name="model">order.status</field>
        </record>

        <record id="model_commission_external" model="ir.model">
            <field name="model">commission.external</field>
        </record>

        <record id="model_commission_internal" model="ir.model">
            <field name="model">commission.internal</field>
        </record>

        <record id="model_order_status_history" model="ir.model">
            <field name="model">order.status.history</field>
        </record>

        <record id="model_order_status_change_wizard" model="ir.model">
            <field name="model">order.status.change.wizard</field>
        </record>

        <record id="model_order_status_report" model="ir.model">
            <field name="model">order.status.report</field>
        </record>

        <!-- Order Status Workflow Security Groups -->

        <!-- Draft Stage Group -->
        <record id="group_order_draft_user" model="res.groups">
            <field name="name">Order Draft Users</field>
            <field name="category_id" ref="base.module_category_sales_sales"/>
            <field name="comment">Users who can create and edit draft orders</field>
        </record>

        <!-- Documentation Review Group -->
        <record id="group_order_documentation_reviewer" model="res.groups">
            <field name="name">Order Documentation Reviewers</field>
            <field name="category_id" ref="base.module_category_sales_sales"/>
            <field name="comment">Users responsible for reviewing and preparing order documentation</field>
        </record>

        <!-- Commission Calculation Group -->
        <record id="group_order_commission_calculator" model="res.groups">
            <field name="name">Order Commission Calculators</field>
            <field name="category_id" ref="base.module_category_sales_sales"/>
            <field name="comment">Users responsible for calculating commission amounts</field>
        </record>

        <!-- Allocation Management Group -->
        <record id="group_order_allocation_manager" model="res.groups">
            <field name="name">Order Allocation Managers</field>
            <field name="category_id" ref="base.module_category_sales_sales"/>
            <field name="comment">Users responsible for managing order allocation stage</field>
        </record>

        <!-- Order Approval Group (Standard) -->
        <record id="group_order_approval_manager" model="res.groups">
            <field name="name">Order Approval Managers</field>
            <field name="category_id" ref="base.module_category_sales_sales"/>
            <field name="comment">Managers who can approve orders</field>
        </record>

        <!-- Final Review and Approval Group -->
        <record id="group_order_approval_manager_enhanced" model="res.groups">
            <field name="name">Order Approval Managers Enhanced</field>
            <field name="category_id" ref="base.module_category_sales_sales"/>
            <field name="comment">Managers who can approve/reject orders for posting</field>
        </record>

        <!-- Sales Order Posting Group -->
        <record id="group_order_posting_manager" model="res.groups">
            <field name="name">Order Posting Managers</field>
            <field name="category_id" ref="base.module_category_sales_sales"/>
            <field name="comment">Managers who can post approved orders as sales orders</field>
        </record>

        <!-- Super Admin Group for Order Status Override -->
        <record id="group_order_status_admin" model="res.groups">
            <field name="name">Order Status System Administrator</field>
            <field name="category_id" ref="base.module_category_sales_sales"/>
            <field name="comment">Full administrative access to order status system</field>
            <field name="implied_ids" eval="[(4, ref('group_order_draft_user')), (4, ref('group_order_documentation_reviewer')), (4, ref('group_order_commission_calculator')), (4, ref('group_order_allocation_manager')), (4, ref('group_order_approval_manager')), (4, ref('group_order_approval_manager_enhanced')), (4, ref('group_order_posting_manager'))]"/>
        </record>

        <!-- Enhanced Sales Manager Group with Action Window Access -->
        <record id="group_sales_manager_enhanced" model="res.groups">
            <field name="name">Enhanced Sales Manager</field>
            <field name="category_id" ref="base.module_category_sales_sales"/>
            <field name="comment">Sales manager with extended permissions for order workflow</field>
            <field name="implied_ids" eval="[(4, ref('sales_team.group_sale_manager')), (4, ref('group_order_status_admin'))]"/>
        </record>

        <!-- Commission Management Groups -->
        <record id="group_commission_internal_manager" model="res.groups">
            <field name="name">Internal Commission Managers</field>
            <field name="category_id" ref="base.module_category_sales_sales"/>
            <field name="comment">Users who can manage internal commission structures</field>
        </record>

        <record id="group_commission_external_manager" model="res.groups">
            <field name="name">External Commission Managers</field>
            <field name="category_id" ref="base.module_category_sales_sales"/>
            <field name="comment">Users who can manage external commission partners</field>
        </record>

        <!-- Record Rules for Security -->

        <!-- Order Status Model Rules -->
        <record id="order_status_user_rule" model="ir.rule">
            <field name="name">Order Status User Access</field>
            <field name="model_id" ref="model_order_status"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('sales_team.group_sale_salesman'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="order_status_manager_rule" model="ir.rule">
            <field name="name">Order Status Manager Access</field>
            <field name="model_id" ref="model_order_status"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('sales_team.group_sale_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Commission Data Rules -->
        <record id="commission_internal_rule" model="ir.rule">
            <field name="name">Internal Commission Data Access</field>
            <field name="model_id" ref="model_commission_internal"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_commission_internal_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <record id="commission_external_rule" model="ir.rule">
            <field name="name">External Commission Data Access</field>
            <field name="model_id" ref="model_commission_external"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_commission_external_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Sale Order Enhanced Rules -->
        <record id="sale_order_enhanced_rule" model="ir.rule">
            <field name="name">Sale Order Enhanced Workflow Access</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_order_status_admin'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Action Window Access Rules for Sales Teams -->
        <record id="ir_actions_act_window_sales_rule" model="ir.rule">
            <field name="name">Action Window Sales Access</field>
            <field name="model_id" ref="base.model_ir_actions_act_window"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('sales_team.group_sale_salesman')), (4, ref('sales_team.group_sale_manager')), (4, ref('group_order_status_admin'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Action Window Manager Access Rules -->
        <record id="ir_actions_act_window_manager_rule" model="ir.rule">
            <field name="name">Action Window Manager Access</field>
            <field name="model_id" ref="base.model_ir_actions_act_window"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('sales_team.group_sale_manager')), (4, ref('group_order_status_admin'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

    </data>
</odoo>
